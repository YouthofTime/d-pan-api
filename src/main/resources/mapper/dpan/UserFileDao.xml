<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zym.dpan.dao.UserFileDao">

	<!-- 可根据自己的需求，是否要使用 -->
    <resultMap type="com.zym.dpan.entity.UserFileEntity" id="userFileMap">
        <result property="fileId" column="file_id"/>
        <result property="userId" column="user_id"/>
        <result property="parentId" column="parent_id"/>
        <result property="realFileId" column="real_file_id"/>
        <result property="filename" column="filename"/>
        <result property="folderFlag" column="folder_flag"/>
        <result property="fileSizeDesc" column="file_size_desc"/>
        <result property="fileType" column="file_type"/>
        <result property="delFlag" column="del_flag"/>
        <result property="createUser" column="create_user"/>
        <result property="createTime" column="create_time"/>
        <result property="updateUser" column="update_user"/>
        <result property="updateTime" column="update_time"/>
    </resultMap>
    <sql id="Base_Column_List">
        file_id, user_id, parent_id, real_file_id, filename, folder_flag, file_size_desc, file_type, del_flag, create_user, create_time, update_user, update_time
    </sql>
    <insert id="insert" parameterType="com.zym.dpan.entity.UserFileEntity">
        insert into d_pan_user_file (file_id, user_id, parent_id,
          real_file_id, filename, folder_flag,
          file_size_desc, file_type, del_flag,
          create_user, create_time, update_user,
          update_time)
        values (#{fileId}, #{userId}, #{parentId},
          #{realFileId}, #{filename}, #{folderFlag},
          #{fileSizeDesc}, #{fileType}, #{delFlag},
          #{createUser}, #{createTime}, #{updateUser},
          #{updateTime})
    </insert>
    <select id="selectByFileIdAndUserId" resultMap="userFileMap">
        select
            <include refid="Base_Column_List"></include>
        from
            d_pan_user_file
        where
            file_id=#{fileId}
        and
            user_id=#{userId}
    </select>
    <select id="selectByParentId" resultMap="userFileMap">
        select
            <include refid="Base_Column_List"></include>
        from
            d_pan_user_file
        where
            parent_id = #{parentId}
        and
            del_flag = #{delFlag}
        and
            user_id = #{userId}
    </select>
    <select id="selectFolderListByUserId" resultType="com.zym.dpan.entity.UserFileEntity">
        select
            <include refid="Base_Column_List"></include>
        from
            d_pan_user_file
        where
            user_id = #{userId}
        and
            del_flag = #{delFlag}
        and
            folder_flag = #{folderFlag}
    </select>

    <select id="selectTopFolderByUserId" resultMap="userFileMap">
        SELECT
        <include refid="Base_Column_List"/>
        FROM
            d_pan_user_file
        WHERE
            user_id = #{userId}
        AND del_flag = 0
        AND parent_id = 0
        AND folder_flag = 1
    </select>

</mapper>